# コマンド選択アルゴリズム

## 概要
キーワードではなく、意図と要件に基づいてタスクにコマンドをマッチングします。

## プロセス

### 1. コマンド発見
- `~/.claude/commands/`と`.claude/commands/`をスキャン
- コマンドファイルからYAMLメタデータを読み取る
- 利用可能なコマンドリストを構築

### 2. タスク分析
ユーザーが何を望んでいるかを理解：
- **意図**: バグ修正、機能追加、調査、最適化？
- **範囲**: 単一ファイルまたは複数コンポーネント？
- **複雑さ**: 単純な変更または複数ステッププロセス？

### 3. パターンマッチング

タスク特性をコマンドにマッチング：

| タスクの意図 | 主要コマンド | 代替 |
|------------|------------|------|
| 小さなバグ修正 | `/fix` | `/hotfix`（本番の場合） |
| 機能追加 | `/think` → `/code` → `/test` | - |
| 問題調査 | `/research` → `/fix` | - |
| 緊急修正 | `/hotfix` | - |
| コード理解 | `/research` | - |
| 複雑な作業の計画 | `/think` | - |

### 4. 選択基準

以下に基づいてコマンドを選択：
- **理解レベル**: コマンド提案には≥70%
- **タスクの複雑さ**: 単一vs複数ステップ
- **環境**: 開発vs本番
- **緊急度**: 通常vs重大

## 例

### 例1: バグ調査
ユーザー: 「認証が壊れている」
- **意図**: バグ修正
- **調査が必要**: はい
- **結果**: `/research` → `/fix`

### 例2: 機能リクエスト
ユーザー: 「ダークモードトグルを追加」
- **意図**: 機能追加
- **複雑さ**: 複数ステップ
- **結果**: `/think` → `/code` → `/test`

### 例3: 本番緊急事態
ユーザー: 「サイトがダウン、データベース接続が失敗」
- **緊急度**: 重大
- **環境**: 本番
- **結果**: `/hotfix`

## エッジケース

### 曖昧な意図
不明な場合は、理解度確認で明確化を求める。

### コマンドマッチなし
`Command: N/A`を使用して直接実装に進む。

### 複数の有効なアプローチ
ユーザーが選択できるよう理解度確認でオプションを提示。
