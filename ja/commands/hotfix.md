---
name: hotfix
description: 本番環境の緊急対応が必要な重大な問題を修正
priority: high
suitable_for:
  scale: [small, medium]
  type: [fix]
  understanding: "≥ 70%"
  urgency: [high]  # Only for urgent issues
  environment: production
  severity: [critical, security]
aliases: [emergency-fix, prod-fix]
timeout: 60
context:
  files_changed: "< 10"
  lines_changed: "< 200"
  new_features: false
  breaking_changes: true  # May need breaking changes for security
excludes: [fix]  # Don't suggest both
---

# /hotfix - 緊急ホットフィックス

## 目的

品質を維持しながら、最小限のプロセスオーバーヘッドで本番環境の重大な問題に対して緊急修正を適用します。

## 使用方法

即座の対応が必要な緊急の本番バグに使用します。

## ワークフロー

合理化された重要パス：素早い分析 → 修正 → テスト → デプロイ準備

## 安全性チェック

**必須**: hotfixを進める前に：

1. **影響評価**: 本番環境が本当に影響を受けているか？
2. **ロールバック準備**: 現在のバージョン/コミットを記録
3. **最小限の修正**: 可能な限り小さな変更範囲を設定
4. **チームへの通知**: ステークホルダーに通知
5. **テスト計画**: クリティカルパステストを定義

⚠️ **警告**: 本番環境の変更は高リスクです。すべてを二重チェックしてください。

## 実行ステップ

### 1. トリアージ (5分)

- 本番環境への影響を確認
- 根本原因を特定
- 最小限の修正を定義

### 2. 修正 (15分)

- 焦点を絞った変更を適用
- 安定性 > エレガンス
- 技術的負債を文書化

### 3. テスト (10分)

- 問題が解決されたことを確認
- クリティカルパスのみチェック
- 包括的なテストは不要

### 4. デプロイ準備

- 明確なコミットメッセージ
- ロールバックを文書化
- チームに通知済み

## TodoWrite統合

緊急トラッキング（シンプルに保つ）：

```md
# HOTFIX: [重大な問題]
1. ⏳ トリアージと評価
2. ⏳ 緊急修正
3. ⏳ クリティカルテスト
```

## 出力フォーマット

```markdown
## 🚨 HOTFIX 概要
- 重大な問題: [説明]
- 重要度: [Critical/High]
- 根本原因: [簡潔な説明]

## 変更内容
- 変更されたファイル: [具体的な変更内容とともにリスト]
- リスク評価: [低/中/高]
- ロールバック計画: [必要な場合の戻し方]

## 検証
- 問題解決: [はい/いいえ]
- テスト合格: [テストのリスト]
- 副作用: [なし/リスト]

## フォローアップ必要事項
- 技術的負債: [クリーンアップが必要な事項]
- 完全テスト: [包括的なテストが必要な事項]
- ドキュメント: [更新が必要な事項]
```

## 使用する場合

- 本番環境がダウンしている
- セキュリティ脆弱性
- データ破損のリスク
- ユーザーに影響する重大なバグ
- 規制コンプライアンスの問題

## 使用しない場合

- 機能リクエスト
- パフォーマンス改善
- リファクタリング
- 重要でないバグ

## 主要原則

- 完璧より先に修正
- すべてを文書化
- クリティカルパスをテスト
- ロールバックを計画
- フォローアップをスケジュール

## 使用例

```md
/hotfix "支払い処理が500エラーを返している"
/hotfix "APIレスポンスでユーザーデータが露出"
/hotfix "デプロイ後にログインが完全に壊れた"
```

## ホットフィックス後のアクション

1. **即座に**: デプロイして監視
2. **24時間以内**: `/reflect` を実行して教訓を文書化
3. **1週間以内**: 完全なワークフローを使用して適切に修正
4. **更新**: 再発防止のためテストケースを追加

## コマンド識別ガイド

### `/hotfix` を使用する場合

- 🚨 本番環境が影響を受けている
- システムがダウンまたは深刻な障害
- セキュリティ脆弱性の発見
- データ整合性のリスク
- 規制コンプライアンスの問題
- ユーザーが重要なアクションを完了できない

### 代わりに `/fix` を使用する場合

- 🔧 開発環境での作業
- 問題が軽微または外観的
- 即座のユーザー影響なし
- 通常のデプロイサイクルを待てる
- テストが標準プロセスに従える

### 主な違い

- **hotfix**: 即座のデプロイが必要な緊急本番修正
- **fix**: 通常のデプロイフローに従う迅速な開発修正
