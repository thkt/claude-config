---
name: think
description: 詳細な分析を行い、包括的な実装計画を作成
priority: high
suitable_for:
  scale: [small, medium, large]
  type: [fix, feature, refactor, optimize]
  understanding: "≥ 50%"
  urgency: [low, medium]
aliases: [plan, analyze]
timeout: 60
requires: ["search tools"]
context:
  files_changed: "any"
  lines_changed: "any"
  new_features: true
  breaking_changes: true
---

# /think - 思考と計画

## 目的
問題の詳細な分析を実行し、実装のための包括的な計画（SOW）を作成します。

## 使用モード
- **スタンドアロン**: 特定の問題や機能の計画
- **ワークフロー**: ワークフローの最初のステップとして実行し、その後 `/research` へ進む

## 前提条件
- スタンドアロンとワークフロー使用の両方で前提条件なし

## 実行ステップ

### 1. 問題分析
- 問題の詳細な理解と定義
- 影響範囲の特定
- 既存実装との関係確認

### 2. 情報収集
- 関連ファイルの検索（Grep、Globを使用）
- 既存コードの分析
- 類似実装の調査

### 3. 要件整理
- 機能要件の明確化
- 非機能要件の確認
- 制約事項の特定

### 4. SOLID原則による解決策の評価
開発原則を評価基準として考慮：
- ソリューションはProgressive Enhancementに従うか？
- コードは読みやすく保守可能か？
- コンポーネントは適切に分離されているか？

- 評価時にSOLID設計原則を適用：
  - **SRP**: 各コンポーネントが1つの明確な責任を持つ
  - **OCP**: 修正なしで拡張できる設計
  - **LSP**: 適切な継承関係を確保
  - **ISP**: 大きなインターフェースより焦点を絞ったインターフェース
  - **DIP**: 実装ではなく抽象に依存
- 原則の遵守に基づいてアプローチを比較
- SOWでSOLIDの適用を文書化
- 拡張性とテスト可能性を考慮
- リスクと緩和策を評価

### 5. 実装計画
- SRPに従ってタスクを分解（各タスク = 1つの責任）
- インターフェースと契約を設計（DIP）
- 拡張性のための計画（OCP）
- 依存関係に基づいて優先順位付け
- 作業時間の見積もり
- 必要なリソースの特定

### 6. TodoWrite統合
- 計画タスクを自動作成
- SOW作成の進捗を追跡

### 7. SOW品質チェック
- 要件の完全性
- アプローチの実現可能性
- 現実的な時間見積もり

## 対話的な要件確認
不明確な点がある場合は、以下のような質問をします：
- 具体的な動作要件
- エラー条件
- 期待される結果

## SOW（作業明細書）フォーマット

```markdown
# [タイトル]

## 概要/目的
[問題の背景と解決策の目的]

## 現状の問題点
[調査で発見された具体的な問題]

## 関連ファイル
[影響を受ける/参照すべきファイルのリスト]

## 提案する解決策
[選択した解決アプローチの詳細]

### SOLID原則の適用
- SRP: [責任がどのように分離されているか]
- OCP: [解決策がどのように拡張を可能にするか]
- DIP: [主要な抽象化/インターフェース]

## 実装計画
1. [ステップ1 - 単一責任]
2. [ステップ2 - 単一責任]
...

## 期待される効果
[実装から期待される効果]

## 考慮事項
[リスク、制約、注意事項]

## 作業時間見積もり
[各ステップに必要な時間]
```

## SOWドキュメントの処理
- SOWを`.claude/workspace/tasks/active/`ディレクトリに保存
- ディレクトリが存在しない場合は`mkdir -p`で作成
- ファイル名形式: `YYYY-MM-DD-task-title.md`
- 例: `2024-03-15-user-auth-improvement.md`
- タイトル部分にはkebab-caseを使用
- Writeツールを使用して完全なSOWを保存
- 既存タスクを更新する場合は上書き

## 完了の定義
計画は以下の場合に完了：
- 問題が完全に理解され文書化された
- 影響を受けるすべてのファイルが特定された
- ソリューションアプローチがSOLID原則に対して検証された
- 実装ステップが明確に定義された
- SOWドキュメントがワークスペースに保存された
- TodoWriteタスクが作成された

## コマンド選択ガイド

### `/think` を使用する場合：
- 📋 新機能の実装が必要
- 🔄 大規模なリファクタリングが必要
- ❓ 問題が完全に理解されていない
- 📊 複数のソリューションを評価する必要がある
- 🎯 包括的な計画が必要

### 他のコマンドを代わりに使用：
- `/fix` - 小さくてよく理解された問題
- `/research` - 技術調査のみ
- `/code` - 明確な要件での実装

## 次のステップ
- **ワークフローモード**: SOWに基づき、技術調査のため `/research` へ進む
- **スタンドアロンモード**: SOWに基づき、直接実装または他の作業へ進む

## 使用例
```
# スタンドアロン使用
/think "ファイルアップロードのエラーメッセージが表示されない"

# ワークフロー使用
/think "PostFileUploadコンポーネントを改善"

# Issue URLからの分析
/think "https://github.com/owner/repo/issues/123"
```

## 自動適用
このコマンドは以下の際にSOLID設計原則を自動的に適用します：
- 解決策のアーキテクチャ
- コンポーネント設計
- インターフェース定義
- 依存関係管理

これらの原則は、保守可能で柔軟なコードを作成するための決定を導きます。
